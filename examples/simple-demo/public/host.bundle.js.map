{
  "version": 3,
  "sources": ["../src/host-browser.ts"],
  "sourcesContent": ["import { WebRtcHttpServer } from \"@http-over-webrtc/server\";\n\nconst ws = new WebSocket('ws://localhost:8080');\nconst pc = new RTCPeerConnection({\n    iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]\n});\n\npc.ondatachannel = (event: RTCDataChannelEvent) => {\n    const dc = event.channel;\n    if (dc.label === 'http-proxy') {\n        console.log(\"Host: DataChannel 'http-proxy' opened\");\n\n        dc.onmessage = (e: MessageEvent) => {\n            const req = JSON.parse(e.data);\n            console.log(\"Host: Received request\", req.path);\n\n            if (req.path === \"/p2p/index.html\") {\n                const res = {\n                    type: \"HTTP_RES\",\n                    id: req.id,\n                    status: 200,\n                    mime: \"text/html\",\n                    data: \"<h1>Hello from Browser Host!</h1><p>This page was loaded over WebRTC.</p><p><img src='/p2p/logo.png' alt='1x1 red dot'></p>\",\n                    complete: true\n                };\n                dc.send(JSON.stringify(res));\n            } else if (req.path === \"/p2p/logo.png\") {\n                const res = {\n                    type: \"HTTP_RES\",\n                    id: req.id,\n                    status: 200,\n                    mime: \"image/png\",\n                    data: \"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg==\",\n                    complete: true\n                };\n                dc.send(JSON.stringify(res));\n            }\n        };\n    }\n};\n\npc.onicecandidate = (event: RTCPeerConnectionIceEvent) => {\n    if (event.candidate) {\n        ws.send(JSON.stringify({ type: 'candidate', candidate: event.candidate, from: 'host' }));\n    }\n};\n\nws.onopen = () => {\n    console.log('Host: Connected to signaling server');\n};\n\nws.onmessage = async (event: MessageEvent) => {\n    const msg = JSON.parse(event.data);\n    if (msg.from === 'host') return;\n\n    if (msg.type === 'offer') {\n        await pc.setRemoteDescription(new RTCSessionDescription(msg.offer));\n        const answer = await pc.createAnswer();\n        await pc.setLocalDescription(answer);\n        ws.send(JSON.stringify({ type: 'answer', answer, from: 'host' }));\n    } else if (msg.type === 'candidate') {\n        await pc.addIceCandidate(new RTCIceCandidate(msg.candidate));\n    }\n};\n\ndocument.body.innerHTML = \"<h1>WebRTC Host (Browser)</h1><p>Waiting for client...</p>\";\n"],
  "mappings": ";;;AAEA,MAAM,KAAK,IAAI,UAAU,qBAAqB;AAC9C,MAAM,KAAK,IAAI,kBAAkB;AAAA,IAC7B,YAAY,CAAC,EAAE,MAAM,+BAA+B,CAAC;AAAA,EACzD,CAAC;AAED,KAAG,gBAAgB,CAAC,UAA+B;AAC/C,UAAM,KAAK,MAAM;AACjB,QAAI,GAAG,UAAU,cAAc;AAC3B,cAAQ,IAAI,uCAAuC;AAEnD,SAAG,YAAY,CAAC,MAAoB;AAChC,cAAM,MAAM,KAAK,MAAM,EAAE,IAAI;AAC7B,gBAAQ,IAAI,0BAA0B,IAAI,IAAI;AAE9C,YAAI,IAAI,SAAS,mBAAmB;AAChC,gBAAM,MAAM;AAAA,YACR,MAAM;AAAA,YACN,IAAI,IAAI;AAAA,YACR,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,MAAM;AAAA,YACN,UAAU;AAAA,UACd;AACA,aAAG,KAAK,KAAK,UAAU,GAAG,CAAC;AAAA,QAC/B,WAAW,IAAI,SAAS,iBAAiB;AACrC,gBAAM,MAAM;AAAA,YACR,MAAM;AAAA,YACN,IAAI,IAAI;AAAA,YACR,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,MAAM;AAAA,YACN,UAAU;AAAA,UACd;AACA,aAAG,KAAK,KAAK,UAAU,GAAG,CAAC;AAAA,QAC/B;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AAEA,KAAG,iBAAiB,CAAC,UAAqC;AACtD,QAAI,MAAM,WAAW;AACjB,SAAG,KAAK,KAAK,UAAU,EAAE,MAAM,aAAa,WAAW,MAAM,WAAW,MAAM,OAAO,CAAC,CAAC;AAAA,IAC3F;AAAA,EACJ;AAEA,KAAG,SAAS,MAAM;AACd,YAAQ,IAAI,qCAAqC;AAAA,EACrD;AAEA,KAAG,YAAY,OAAO,UAAwB;AAC1C,UAAM,MAAM,KAAK,MAAM,MAAM,IAAI;AACjC,QAAI,IAAI,SAAS,OAAQ;AAEzB,QAAI,IAAI,SAAS,SAAS;AACtB,YAAM,GAAG,qBAAqB,IAAI,sBAAsB,IAAI,KAAK,CAAC;AAClE,YAAM,SAAS,MAAM,GAAG,aAAa;AACrC,YAAM,GAAG,oBAAoB,MAAM;AACnC,SAAG,KAAK,KAAK,UAAU,EAAE,MAAM,UAAU,QAAQ,MAAM,OAAO,CAAC,CAAC;AAAA,IACpE,WAAW,IAAI,SAAS,aAAa;AACjC,YAAM,GAAG,gBAAgB,IAAI,gBAAgB,IAAI,SAAS,CAAC;AAAA,IAC/D;AAAA,EACJ;AAEA,WAAS,KAAK,YAAY;",
  "names": []
}
